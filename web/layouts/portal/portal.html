{{template "base.html" .}}

{{define "title"}}Portal{{end}}

{{define "body_class"}}pc-vertical-stretch{{end}}

{{define "main"}}
<div class="flex flex-1 bg-white">
    <div class="flex flex-1 flex-col px-4 mx-auto sm:px-6 lg:px-8 max-w-7xl">
        <div class="flex items-center justify-between py-8 " x-data="{org: '', select(org) { this.org = org; } }" x-init="org = '{{ .Params.CurrentOrg.Name }}'">
            <div>
                <div class="mx-auto max-w-7xl">
                    <div class="max-w-xs mx-auto" x-data="{open: false, toggle() { this.open = ! this.open }, close() { this.open = false; } }">
                        <div class="absolute top-0 left-0 w-full h-screen z-0 bg-transparent" x-on:click="toggle()" x-show="open"></div>
                        <div class="relative">
                            <div x-on:click="toggle()" class="cursor-pointer block w-full py-3 px-4 border-gray-300 border rounded-lg focus:outline-none focus:ring-indigo-600 focus:border-indigo-600 sm:text-sm">
                                <div class="flex justify-between items-center">
                                    <div class="flex items-center justify-start space-x-2">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                            <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z" />
                                        </svg>
                                        <span class="ml-1" x-text="org"></span>
                                    </div>
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 ml-1" x-bind:class="! open ? '' : 'transform rotate-180'" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7" />
                                    </svg>
                                </div>
                            </div>

                            <div class="absolute mt-2 w-full min-w-60 z-10" x-show="open">
                                <div class="border-gray-300 bg-white shadow border rounded-lg w-full block text-sm px-4 py-2 space-y-2">
                                    <ul class="flex flex-col">
                                        {{ range $org := .Params.Orgs }}
                                        <li class="w-full rounded-md p-2 hover:bg-gray-100 cursor-pointer{{ if eq $org.ID $.Params.CurrentOrg.ID }} bg-gray-100{{end}}"
                                            @click="open = false"
                                            hx-target="#properties"
                                            hx-trigger="click"
                                            hx-get="{{ partsURL $.Const.OrgEndpoint $org.ID $.Const.PropertiesEndpoint }}">
                                            {{ $org.Name }}
                                        </li>
                                        {{end}}
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <a
                href="{{ partsURL .Const.OrgEndpoint .Params.CurrentOrg.ID .Const.PropertyEndpoint .Const.NewEndpoint }}"
                type="button"
                class="inline-flex items-center justify-center px-5 py-2.5 text-sm leading-4 rounded-md border border-indigo-600 transition-all duration-200 text-indigo-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-600 focus:bg-indigo-500 focus:text-white hover:bg-indigo-50 font-semibold"
            >
                <svg class="w-5 h-5 mr-2 -ml-1" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
                </svg>
                Add New Property
            </a>
        </div>
        <hr class="border-gray-200" />
        <div id="properties" class="flex flex-1">
            {{template "properties.html" .}}
        </div>
    </div>
</div>
{{end}}
